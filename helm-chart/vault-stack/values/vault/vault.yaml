# Vault configuration for official HashiCorp Helm chart
vault:
  enabled: true

  global:
    enabled: true
    namespace: vault-stack

  server:
    enabled: true
    image:
      repository: "hashicorp/vault-enterprise"
      tag: "1.20-ent"
      pullPolicy: IfNotPresent

    # Vault Enterprise license
    enterpriseLicense:
      secretName: vault-license
      secretKey: license

    # Resources
    resources:
      requests:
        memory: 512Mi
        cpu: 250m
      limits:
        memory: 1Gi
        cpu: 500m

    # Service configuration
    service:
      enabled: true
      type: ClusterIP
      port: 8200

    # Data storage
    dataStorage:
      enabled: true
      size: 10Gi
      storageClass: null

    # Audit storage
    auditStorage:
      enabled: true
      size: 5Gi
      storageClass: null

    # High Availability with Raft
    ha:
      enabled: true
      replicas: 1
      raft:
        enabled: true
        setNodeId: true
        config: |
          ui = true

          listener "tcp" {
            tls_disable = 1
            address = "[::]:8200"
            cluster_address = "[::]:8201"
          }

          storage "raft" {
            path = "/vault/data"
          }

          service_registration "kubernetes" {}

          telemetry {
            disable_hostname = true
            prometheus_retention_time = "12h"
            unauthenticated_metrics_access = true
          }

  # UI configuration
  ui:
    enabled: true
    serviceType: "ClusterIP"

  # Injector (not needed for this stack)
  injector:
    enabled: false
