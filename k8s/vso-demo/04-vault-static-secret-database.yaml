---
# VaultStaticSecret for database credentials
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: database-secret
  namespace: vault-stack
spec:
  # Reference to the VaultConnection
  vaultConnectionRef: vault-connection

  # Reference to the VaultAuth
  vaultAuthRef: vault-auth

  # Mount path of the KV secrets engine
  mount: kvv2

  # Type of secret (kv-v2 for KV version 2)
  type: kv-v2

  # Path to the secret in Vault (without the mount prefix)
  path: database/config

  # Name of the Kubernetes secret to create/update
  destination:
    name: database-secret
    create: true

  # Refresh interval - how often to check Vault for updates
  refreshAfter: 30s

  # Rollout restart targets - pods to restart when secret changes
  rolloutRestartTargets:
    - kind: Deployment
      name: webapp-deployment
